---
title: "Data 608 Homework 1"
author: "Jeff Nieman"
date: "January 30, 2017"
output: html_document
---

Question 1:  Create a graph that shows the distribution of companies in the dataset by State (i.e. how many are in each state)

```{r}
Inc5000 <- read.csv("https://raw.githubusercontent.com/charleyferrari/CUNY_DATA608/master/lecture1/Data/inc5000_data.csv")
library(ggplot2)
library(dplyr)

#Inc.1 <- summarise(group_by(Inc5000,State), count = n())

ggplot(Inc5000, aes(x=State),xlab="Number of Companies") + geom_bar(fill="lightgreen") + coord_flip() + ylab("Number of Companies") + ggtitle("Graph Showing Number of Inc5000 Companies by State")

ggsave("Question1_Plot.png")


```

Question 2: Let's dig in on the State with the 3rd most companies in the data set.  Imagine  you work for the state and are interested in how many people are employed by companies in different industries employ. Create a plot of average employment by industry for companies in this state.  

```{r, echo=FALSE}

#Inc.1$comp_no <- as.numeric(Inc.1$count)
#ranking from question 1 to find state with 3rd most companies
#ggplot(Inc.1, aes(x=State, y=comp_no)) + geom_bar(fill="lightgreen") + coord_flip() + ylab("Number of Companies") + ggtitle("Graph Showing Number of Inc5000 Companies by State")



ny <- subset(Inc5000,State=='NY')
ny1 <- ny[complete.cases(ny),]

#check for outliers
hist(ny1$Employees, breaks = 50, col="cornflowerblue")
#ignore companies with > 9000 employees as outliers
ny2 <- subset(ny1,Employees < 10000)
#Recheck histogram
hist(ny2$Employees, breaks = 50, col="cornflowerblue")

ny3 <- summarise(group_by(ny2,Industry), avg=mean(Employees))
ggplot(ny3, aes(x=reorder(Industry,avg), y=avg)) + geom_bar(stat="identity",fill="blue") + coord_flip() + ylab("Average Number of Employees") + xlab("Industry")+ ggtitle("Average Employees in NY Inc5000 Companies by Industry")

ggsave("Question2_Plot.png")

```

Question 3:  Now imagine you work for an investor and want to see which industries generate the most revenue per employee.  Create a chart that makes this information clear.

```{r}
Inc <- Inc5000[complete.cases(Inc5000),]
Inc1 <- summarise(group_by(Inc,Industry), EmpTotal = sum(Employees), RevTotal = sum(Revenue))
Inc1$Rev_per_Emp<- Inc1$RevTotal/Inc1$EmpTotal

ggplot(Inc1, aes(x=reorder(Industry,Rev_per_Emp), y=Rev_per_Emp)) + geom_bar(stat="identity",fill="red") + coord_flip() + ylab("Average Revenue per Employee") + ggtitle("Average Revenue Generated by Industry")

ggsave("Question3_Plot.png")




```

